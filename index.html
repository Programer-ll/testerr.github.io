<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NBA 2K25 Shot Timing Trainer</title>
  <style>
    body {
      background-color: #0d0d0d;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
    }

    h1 {
      font-size: 2em;
    }

    #status {
      margin: 20px 0;
      font-size: 1.5em;
    }

    button {
      padding: 12px 20px;
      font-size: 16px;
      background: #1e90ff;
      border: none;
      color: white;
      cursor: pointer;
    }

    #player {
      width: 200px;
      height: 200px;
      margin: 40px auto;
      background: url('https://i.imgur.com/NpT2Zqg.png') no-repeat center;
      background-size: contain;
      transition: transform 0.2s ease, filter 0.3s ease;
    }

    .shooting {
      transform: translateY(-10px) scale(1.1);
    }

    .green {
      filter: drop-shadow(0 0 12px lime);
    }

    .early, .late {
      filter: drop-shadow(0 0 12px red);
    }

    #log {
      max-width: 400px;
      margin: 20px auto;
      text-align: left;
    }

    #log p {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h1>üèÄ NBA 2K25 Shot Timing Trainer</h1>
  <p>Press and hold your shoot button, then release to get visual and timing feedback.</p>

  <button id="connect">üéÆ Connect Gamepad</button>

  <div id="player"></div>
  <div id="status">Waiting for input‚Ä¶</div>
  <div id="log"></div>

  <script>
    let gamepadIndex = null;
    const SHOOT_BUTTON = 0;
    const IDEAL = 0.55;
    const TOLERANCE = 0.05;
    let isPressing = false;
    let startTime = 0;

    const statusEl = document.getElementById('status');
    const playerEl = document.getElementById('player');
    const logEl = document.getElementById('log');

    function log(message, className) {
      const entry = document.createElement('p');
      entry.textContent = message;
      if (className) entry.classList.add(className);
      logEl.prepend(entry);
    }

    function updateGamepad() {
      const gp = navigator.getGamepads()[gamepadIndex];
      if (!gp) return requestAnimationFrame(updateGamepad);

      const button = gp.buttons[SHOOT_BUTTON];

      if (button.pressed && !isPressing) {
        isPressing = true;
        startTime = performance.now();
        statusEl.textContent = "‚è± Shot started...";
        playerEl.classList.add("shooting");
        playerEl.classList.remove("green", "early", "late");
      }

      if (!button.pressed && isPressing) {
        isPressing = false;
        const duration = (performance.now() - startTime) / 1000;
        const diff = duration - IDEAL;

        let feedback = "";
        playerEl.classList.remove("shooting", "green", "early", "late");

        if (Math.abs(diff) <= TOLERANCE) {
          feedback = `‚úÖ Green! ${duration.toFixed(2)}s`;
          statusEl.innerHTML = `<span class="green">${feedback}</span>`;
          playerEl.classList.add("green");
        } else if (diff < 0) {
          feedback = `‚è± Too Early ‚Äì ${duration.toFixed(2)}s`;
          statusEl.innerHTML = `<span class="early">${feedback}</span>`;
          playerEl.classList.add("early");
        } else {
          feedback = `‚è± Too Late ‚Äì ${duration.toFixed(2)}s`;
          statusEl.innerHTML = `<span class="late">${feedback}</span>`;
          playerEl.classList.add("late");
        }

        log(feedback);
      }

      requestAnimationFrame(updateGamepad);
    }

    document.getElementById('connect').addEventListener('click', () => {
      window.addEventListener("gamepadconnected", (e) => {
        gamepadIndex = e.gamepad.index;
        statusEl.textContent = `üéÆ Gamepad connected: ${e.gamepad.id}`;
        updateGamepad();
      });
      alert("Press a button on your controller to connect.");
    });
  </script>
</body>
</html>
